--
-- ER/Studio 8.0 SQL Code Generation
-- Company :      c
-- Project :      disposable.dm1
-- Author :       Casey
--
-- Date Created : Sunday, October 20, 2013 00:14:50
-- Target DBMS : MySQL 5.x
--

-- 
-- TABLE: DISPOSABLE.APP 
--

CREATE TABLE DISPOSABLE.APP(
    APP_SID    INT UNSIGNED  NOT NULL,
    PRIMARY KEY (APP_SID)
)ENGINE=INNODB
;



-- 
-- TABLE: DISPOSABLE.APP_OBJECT 
--

CREATE TABLE DISPOSABLE.APP_OBJECT(
    APP_SID       INT UNSIGNED  NOT NULL,
    OBJECT_SID    INT UNSIGNED  NOT NULL,
    PRIMARY KEY (APP_SID, OBJECT_SID)
)ENGINE=INNODB
;



-- 
-- TABLE: DISPOSABLE.AUTHORIZABLE_OBJECT 
--

CREATE TABLE DISPOSABLE.AUTHORIZABLE_OBJECT(
    APP_SID       INT UNSIGNED  NOT NULL,
    OBJECT_SID    INT UNSIGNED  NOT NULL,
    PRIMARY KEY (APP_SID, OBJECT_SID)
)ENGINE=INNODB
;



-- 
-- TABLE: DISPOSABLE.CLASS_TYPE 
--

CREATE TABLE DISPOSABLE.CLASS_TYPE(
    CLASS_TYPE_ID    INT             NOT NULL,
    DESCRIPTION      VARCHAR(100)    NOT NULL,
    PRIMARY KEY (CLASS_TYPE_ID)
)ENGINE=INNODB
;



-- 
-- TABLE: DISPOSABLE.CLASS_TYPE_PERMISSION 
--

CREATE TABLE DISPOSABLE.CLASS_TYPE_PERMISSION(
    APP_SID                    INT UNSIGNED  NOT NULL,
    PRIMARY_CLASS_TYPE_ID      INT    NOT NULL,
    SECONDARY_CLASS_TYPE_ID    INT    NOT NULL,
    PERMISSION_ID              INT    NOT NULL,
    PRIMARY KEY (APP_SID, PRIMARY_CLASS_TYPE_ID, SECONDARY_CLASS_TYPE_ID, PERMISSION_ID)
)ENGINE=INNODB
;



-- 
-- TABLE: DISPOSABLE.CLASS_TYPE_RELATIONSHIP 
--

CREATE TABLE DISPOSABLE.CLASS_TYPE_RELATIONSHIP(
    APP_SID                    INT UNSIGNED  NOT NULL,
    PRIMARY_CLASS_TYPE_ID      INT    NOT NULL,
    SECONDARY_CLASS_TYPE_ID    INT    NOT NULL,
    PRIMARY KEY (APP_SID, PRIMARY_CLASS_TYPE_ID, SECONDARY_CLASS_TYPE_ID)
)ENGINE=INNODB
;



-- 
-- TABLE: DISPOSABLE.OBJECT_RELATIONSHIP 
--

CREATE TABLE DISPOSABLE.OBJECT_RELATIONSHIP(
    APP_SID                    INT UNSIGNED  NOT NULL,
    AUTHORIZABLE_OBJECT_SID    INT UNSIGNED  NOT NULL,
    TARGET_OBJECT_SID          INT UNSIGNED  NOT NULL,
    PRIMARY KEY (APP_SID, AUTHORIZABLE_OBJECT_SID, TARGET_OBJECT_SID)
)ENGINE=INNODB
;



-- 
-- TABLE: DISPOSABLE.PERMISSION 
--

CREATE TABLE DISPOSABLE.PERMISSION(
    PERMISSION_ID    INT             NOT NULL,
    DESCRIPTION      VARCHAR(100)    NOT NULL,
    PRIMARY KEY (PERMISSION_ID)
)ENGINE=INNODB
;



-- 
-- TABLE: DISPOSABLE.PERMISSION_SET 
--

CREATE TABLE DISPOSABLE.PERMISSION_SET(
    APP_SID                    INT UNSIGNED  NOT NULL,
    PRIMARY_CLASS_TYPE_ID      INT    NOT NULL,
    SECONDARY_CLASS_TYPE_ID    INT    NOT NULL,
    PERMISSION_ID              INT    NOT NULL,
    PERMISSION_TYPE_ID         INT    NOT NULL,
    POSITION                   INT    NOT NULL,
    PRIMARY KEY (APP_SID, PRIMARY_CLASS_TYPE_ID, SECONDARY_CLASS_TYPE_ID, PERMISSION_ID)
)ENGINE=INNODB
;



-- 
-- TABLE: DISPOSABLE.PERMISSION_TYPE 
--

CREATE TABLE DISPOSABLE.PERMISSION_TYPE(
    PERMISSION_TYPE_ID    INT            NOT NULL,
    DESCRIPTION           VARCHAR(10)    NOT NULL,
    PRIMARY KEY (PERMISSION_TYPE_ID)
)ENGINE=INNODB
;



-- 
-- TABLE: DISPOSABLE.ROLE 
--

CREATE TABLE DISPOSABLE.ROLE(
    APP_SID            INT UNSIGNED  NOT NULL,
    ROLE_SID           INT UNSIGNED  NOT NULL,
    SYSTEM_ROLE_SID    INT UNSIGNED,
    PRIMARY KEY (APP_SID, ROLE_SID)
)ENGINE=INNODB
;



-- 
-- TABLE: DISPOSABLE.ROLE_MEMBER 
--

CREATE TABLE DISPOSABLE.ROLE_MEMBER(
    APP_SID       INT UNSIGNED  NOT NULL,
    ROLE_SID      INT UNSIGNED  NOT NULL,
    OBJECT_SID    INT UNSIGNED  NOT NULL,
    PRIMARY KEY (APP_SID, ROLE_SID, OBJECT_SID)
)ENGINE=INNODB
;



-- 
-- TABLE: DISPOSABLE.SECURABLE_OBJECT 
--

CREATE TABLE DISPOSABLE.SECURABLE_OBJECT(
    OBJECT_SID           INT UNSIGNED  AUTO_INCREMENT,
    PARENT_OBJECT_SID    INT UNSIGNED,
    CLASS_TYPE_ID        INT    NOT NULL,
    PRIMARY KEY (OBJECT_SID)
)ENGINE=INNODB
;



-- 
-- TABLE: DISPOSABLE.SYSTEM_DEVICE 
--

CREATE TABLE DISPOSABLE.SYSTEM_DEVICE(
    DEVICE_SID    INT UNSIGNED  NOT NULL,
    PRIMARY KEY (DEVICE_SID)
)ENGINE=INNODB
;



-- 
-- TABLE: DISPOSABLE.SYSTEM_ROLE 
--

CREATE TABLE DISPOSABLE.SYSTEM_ROLE(
    SYSTEM_ROLE_SID    INT UNSIGNED  NOT NULL,
    PRIMARY KEY (SYSTEM_ROLE_SID)
)ENGINE=INNODB
;



-- 
-- TABLE: DISPOSABLE.SYSTEM_USER 
--

CREATE TABLE DISPOSABLE.SYSTEM_USER(
    USER_SID    INT UNSIGNED  NOT NULL,
    PRIMARY KEY (USER_SID)
)ENGINE=INNODB
;



-- 
-- TABLE: DISPOSABLE.SYSTEM_USER_DEVICE 
--

CREATE TABLE DISPOSABLE.SYSTEM_USER_DEVICE(
    DEVICE_SID    INT UNSIGNED  NOT NULL,
    USER_SID      INT UNSIGNED  NOT NULL,
    PRIMARY KEY (DEVICE_SID, USER_SID)
)ENGINE=INNODB
;



-- 
-- TABLE: DISPOSABLE.USER 
--

CREATE TABLE DISPOSABLE.USER(
    USER_SID      INT UNSIGNED  NOT NULL,
    OBJECT_SID    INT UNSIGNED  NOT NULL,
    APP_SID       INT UNSIGNED  NOT NULL,
    PRIMARY KEY (USER_SID, APP_SID, OBJECT_SID)
)ENGINE=INNODB
;



-- 
-- TABLE: DISPOSABLE.USER_DEVICE 
--

CREATE TABLE DISPOSABLE.USER_DEVICE(
    APP_SID       INT UNSIGNED  NOT NULL,
    DEVICE_SID    INT UNSIGNED  NOT NULL,
    USER_SID      INT UNSIGNED  NOT NULL,
    OBJECT_SID    INT UNSIGNED  NOT NULL,
    PRIMARY KEY (APP_SID)
)ENGINE=INNODB
;



-- 
-- TABLE: DISPOSABLE.APP 
--

ALTER TABLE DISPOSABLE.APP ADD CONSTRAINT FK_SECURABLE_OBJECT_APP 
    FOREIGN KEY (APP_SID)
    REFERENCES DISPOSABLE.SECURABLE_OBJECT(OBJECT_SID)
;


-- 
-- TABLE: DISPOSABLE.APP_OBJECT 
--

ALTER TABLE DISPOSABLE.APP_OBJECT ADD CONSTRAINT FK_APP_APP_OBJECT 
    FOREIGN KEY (APP_SID)
    REFERENCES DISPOSABLE.APP(APP_SID)
;

ALTER TABLE DISPOSABLE.APP_OBJECT ADD CONSTRAINT FK_SECURABLE_OBJECT_APP_OBJECT 
    FOREIGN KEY (OBJECT_SID)
    REFERENCES DISPOSABLE.SECURABLE_OBJECT(OBJECT_SID)
;


-- 
-- TABLE: DISPOSABLE.AUTHORIZABLE_OBJECT 
--

ALTER TABLE DISPOSABLE.AUTHORIZABLE_OBJECT ADD CONSTRAINT FK_APP_OBJECT_AUTHORIZABLE_OBJECT 
    FOREIGN KEY (APP_SID, OBJECT_SID)
    REFERENCES DISPOSABLE.APP_OBJECT(APP_SID, OBJECT_SID)
;


-- 
-- TABLE: DISPOSABLE.CLASS_TYPE_PERMISSION 
--

ALTER TABLE DISPOSABLE.CLASS_TYPE_PERMISSION ADD CONSTRAINT FK_CLASS_TYPE_RELATIONSHIP_CLASS_TYPE_PERMISSION 
    FOREIGN KEY (APP_SID, PRIMARY_CLASS_TYPE_ID, SECONDARY_CLASS_TYPE_ID)
    REFERENCES DISPOSABLE.CLASS_TYPE_RELATIONSHIP(APP_SID, PRIMARY_CLASS_TYPE_ID, SECONDARY_CLASS_TYPE_ID)
;

ALTER TABLE DISPOSABLE.CLASS_TYPE_PERMISSION ADD CONSTRAINT FK_PERMISSION_CLASS_TYPE_PERMISSION 
    FOREIGN KEY (PERMISSION_ID)
    REFERENCES DISPOSABLE.PERMISSION(PERMISSION_ID)
;


-- 
-- TABLE: DISPOSABLE.CLASS_TYPE_RELATIONSHIP 
--

ALTER TABLE DISPOSABLE.CLASS_TYPE_RELATIONSHIP ADD CONSTRAINT FK_APP_CLASS_TYPE_RELATIONSHIP 
    FOREIGN KEY (APP_SID)
    REFERENCES DISPOSABLE.APP(APP_SID)
;

ALTER TABLE DISPOSABLE.CLASS_TYPE_RELATIONSHIP ADD CONSTRAINT FK_CLASS_TYPE_CLASS_TYPE_RELATIONSHIP_1 
    FOREIGN KEY (PRIMARY_CLASS_TYPE_ID)
    REFERENCES DISPOSABLE.CLASS_TYPE(CLASS_TYPE_ID)
;

ALTER TABLE DISPOSABLE.CLASS_TYPE_RELATIONSHIP ADD CONSTRAINT FK_CLASS_TYPE_CLASS_TYPE_RELATIONSHIP_2 
    FOREIGN KEY (SECONDARY_CLASS_TYPE_ID)
    REFERENCES DISPOSABLE.CLASS_TYPE(CLASS_TYPE_ID)
;


-- 
-- TABLE: DISPOSABLE.OBJECT_RELATIONSHIP 
--

ALTER TABLE DISPOSABLE.OBJECT_RELATIONSHIP ADD CONSTRAINT FK_APP_OBJECT_OBJECT_RELATIONSHIP 
    FOREIGN KEY (APP_SID, TARGET_OBJECT_SID)
    REFERENCES DISPOSABLE.APP_OBJECT(APP_SID, OBJECT_SID)
;

ALTER TABLE DISPOSABLE.OBJECT_RELATIONSHIP ADD CONSTRAINT FK_AUTHORIZABLE_OBJECT_OBJECT_RELATIONSHIP 
    FOREIGN KEY (APP_SID, AUTHORIZABLE_OBJECT_SID)
    REFERENCES DISPOSABLE.AUTHORIZABLE_OBJECT(APP_SID, OBJECT_SID)
;


-- 
-- TABLE: DISPOSABLE.PERMISSION_SET 
--

ALTER TABLE DISPOSABLE.PERMISSION_SET ADD CONSTRAINT FK_CLASS_TYPE_PERMISSION_PERMISSION_SET 
    FOREIGN KEY (APP_SID, PRIMARY_CLASS_TYPE_ID, SECONDARY_CLASS_TYPE_ID, PERMISSION_ID)
    REFERENCES DISPOSABLE.CLASS_TYPE_PERMISSION(APP_SID, PRIMARY_CLASS_TYPE_ID, SECONDARY_CLASS_TYPE_ID, PERMISSION_ID)
;

ALTER TABLE DISPOSABLE.PERMISSION_SET ADD CONSTRAINT FK_PERMISSION_TYPE_PERMISSION_SET 
    FOREIGN KEY (PERMISSION_TYPE_ID)
    REFERENCES DISPOSABLE.PERMISSION_TYPE(PERMISSION_TYPE_ID)
;


-- 
-- TABLE: DISPOSABLE.ROLE 
--

ALTER TABLE DISPOSABLE.ROLE ADD CONSTRAINT FK_AUTHORIZABLE_OBJECT_ROLE 
    FOREIGN KEY (APP_SID, ROLE_SID)
    REFERENCES DISPOSABLE.AUTHORIZABLE_OBJECT(APP_SID, OBJECT_SID)
;

ALTER TABLE DISPOSABLE.ROLE ADD CONSTRAINT FK_SYSTEM_ROLE_ROLE 
    FOREIGN KEY (SYSTEM_ROLE_SID)
    REFERENCES DISPOSABLE.SYSTEM_ROLE(SYSTEM_ROLE_SID)
;


-- 
-- TABLE: DISPOSABLE.ROLE_MEMBER 
--

ALTER TABLE DISPOSABLE.ROLE_MEMBER ADD CONSTRAINT FK_AUTHORIZABLE_OBJECT_ROLE_MEMBER 
    FOREIGN KEY (APP_SID, OBJECT_SID)
    REFERENCES DISPOSABLE.AUTHORIZABLE_OBJECT(APP_SID, OBJECT_SID)
;

ALTER TABLE DISPOSABLE.ROLE_MEMBER ADD CONSTRAINT FK_ROLE_ROLE_MEMBER 
    FOREIGN KEY (APP_SID, ROLE_SID)
    REFERENCES DISPOSABLE.ROLE(APP_SID, ROLE_SID)
;


-- 
-- TABLE: DISPOSABLE.SECURABLE_OBJECT 
--

ALTER TABLE DISPOSABLE.SECURABLE_OBJECT ADD CONSTRAINT FK_CLASS_TYPE_SECURABLE_OBJECT 
    FOREIGN KEY (CLASS_TYPE_ID)
    REFERENCES DISPOSABLE.CLASS_TYPE(CLASS_TYPE_ID)
;

ALTER TABLE DISPOSABLE.SECURABLE_OBJECT ADD CONSTRAINT FK_SECURABLE_OBJECT_SECURABLE_OBJECT 
    FOREIGN KEY (PARENT_OBJECT_SID)
    REFERENCES DISPOSABLE.SECURABLE_OBJECT(OBJECT_SID)
;


-- 
-- TABLE: DISPOSABLE.SYSTEM_DEVICE 
--

ALTER TABLE DISPOSABLE.SYSTEM_DEVICE ADD CONSTRAINT FK_SECURABLE_OBJECT_SYSTEM_DEVICE 
    FOREIGN KEY (DEVICE_SID)
    REFERENCES DISPOSABLE.SECURABLE_OBJECT(OBJECT_SID)
;


-- 
-- TABLE: DISPOSABLE.SYSTEM_ROLE 
--

ALTER TABLE DISPOSABLE.SYSTEM_ROLE ADD CONSTRAINT FK_SECURABLE_OBJECT_SYSTEM_ROLE 
    FOREIGN KEY (SYSTEM_ROLE_SID)
    REFERENCES DISPOSABLE.SECURABLE_OBJECT(OBJECT_SID)
;


-- 
-- TABLE: DISPOSABLE.SYSTEM_USER 
--

ALTER TABLE DISPOSABLE.SYSTEM_USER ADD CONSTRAINT FK_SECURABLE_OBJECT_SYSTEM_USER 
    FOREIGN KEY (USER_SID)
    REFERENCES DISPOSABLE.SECURABLE_OBJECT(OBJECT_SID)
;


-- 
-- TABLE: DISPOSABLE.SYSTEM_USER_DEVICE 
--

ALTER TABLE DISPOSABLE.SYSTEM_USER_DEVICE ADD CONSTRAINT FK_SYSTEM_DEVICE_SYSTEM_USER_DEVICE 
    FOREIGN KEY (DEVICE_SID)
    REFERENCES DISPOSABLE.SYSTEM_DEVICE(DEVICE_SID)
;

ALTER TABLE DISPOSABLE.SYSTEM_USER_DEVICE ADD CONSTRAINT FK_SYSTEM_USER_SYSTEM_USER_DEVICE 
    FOREIGN KEY (USER_SID)
    REFERENCES DISPOSABLE.SYSTEM_USER(USER_SID)
;


-- 
-- TABLE: DISPOSABLE.USER 
--

ALTER TABLE DISPOSABLE.USER ADD CONSTRAINT FK_AUTHORIZABLE_OBJECT_USER 
    FOREIGN KEY (OBJECT_SID, APP_SID)
    REFERENCES DISPOSABLE.AUTHORIZABLE_OBJECT(APP_SID, OBJECT_SID)
;

ALTER TABLE DISPOSABLE.USER ADD CONSTRAINT FK_SYSTEM_USER_USER 
    FOREIGN KEY (USER_SID)
    REFERENCES DISPOSABLE.SYSTEM_USER(USER_SID)
;


-- 
-- TABLE: DISPOSABLE.USER_DEVICE 
--

ALTER TABLE DISPOSABLE.USER_DEVICE ADD CONSTRAINT FK_APP_USER_DEVICE 
    FOREIGN KEY (APP_SID)
    REFERENCES DISPOSABLE.APP(APP_SID)
;

ALTER TABLE DISPOSABLE.USER_DEVICE ADD CONSTRAINT FK_SYSTEM_USER_DEVICE_USER_DEVICE 
    FOREIGN KEY (DEVICE_SID, USER_SID)
    REFERENCES DISPOSABLE.SYSTEM_USER_DEVICE(DEVICE_SID, USER_SID)
;

ALTER TABLE DISPOSABLE.USER_DEVICE ADD CONSTRAINT FK_USER_USER_DEVICE 
    FOREIGN KEY (APP_SID, USER_SID, OBJECT_SID)
    REFERENCES DISPOSABLE.USER(USER_SID, OBJECT_SID, APP_SID)
;


